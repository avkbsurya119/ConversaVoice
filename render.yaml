databases:
  # Redis for conversation memory
  - name: conversavoice-redis
    type: redis
    plan: free
    region: oregon

services:
  # Service 1: The FastAPI Backend
  - type: web
    name: conversavoice-backend
    env: docker
    region: oregon
    plan: free # Or "starter" for more performance
    dockerfilePath: ./backend/Dockerfile
    envVars:
      - key: PYTHON_VERSION
        value: 3.10.11
      - key: GROQ_API_KEY
        sync: false # Set this in the Render dashboard
      - key: AZURE_SPEECH_KEY
        sync: false # Set this in the Render dashboard
      - key: AZURE_SPEECH_REGION
        sync: false # Set this in the Render dashboard
      - key: REDIS_HOST
        fromDatabase:
          name: conversavoice-redis
          property: host
      - key: REDIS_PORT
        fromDatabase:
          name: conversavoice-redis
          property: port

  # Service 2: The Streamlit Frontend
  - type: web
    name: conversavoice-frontend
    env: docker
    region: oregon
    plan: free
    dockerfilePath: ./frontend/Dockerfile
    envVars:
      - key: PYTHON_VERSION
        value: 3.10.11
      - key: BACKEND_API_URL
        value: https://conversavoice-backend.onrender.com
